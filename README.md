Xgboost_shap.ipynb：
Xgboost_shap.ipynb contains the code for building a classification model to distinguish between Ischemic Stroke (IS) and Healthy Control (HC) groups using relative abundance data of gut microbiota species.
The process begins with data loading and preprocessing using pandas, followed by splitting the data into an 80% training set and a 20% test set. Features in the training set are then selected based on the Mann-Whitney U test (p < 0.05). An XGBoostClassifier is employed, with hyperparameters optimized via RandomizedSearchCV (300 iterations, 3-fold cross-validation). The search space includes learning_rate (0.01-2), subsample (0.7-0.9), colsample_bytree (0.5-0.98), n_estimators (500-2000), and max_depth (10-200).
Model performance is evaluated using 10-fold cross-validation, test set accuracy, ROC curves, and AUC values. Confidence intervals for these metrics are calculated using bootstrapping (1000 iterations). Finally, SHAP analysis is used to interpret feature contributions, generating a summary plot to display the top 20 important features and calculating the mean absolute SHAP value as a measure of feature importance. The trained model, processed data, and feature importance results are all saved. This entire process relies on Python and its libraries, including pandas, numpy, scipy, xgboost, scikit-learn, joblib, matplotlib, and shap.


cobra_agora.pptx：
cobra_agora.pptx details the specific code and workflow for constructing and analyzing personalized gut microbiota metabolic models using the COBRA (Constraint-based Reconstruction and Analysis) Toolbox and the AGORA2 (Assembly of Gut Organisms through Reconstruction and Analysis 2) model library. This aims to predict microbial metabolic characteristics.
First, the createPanModels function is used to convert AGORA2 strain-level models (.mat format) into species-level pan-models. This process requires specifying the model path, output path, taxonomic level, and an information file (AGORA2_infoFile.xlsx). Subsequently, personalized models are constructed in the MATLAB environment using the initMgPipe function. Input parameters for this function include the AGORA2 model path, abundance file path, and a dietary file (e.g., AverageEuropeanDiet.txt). This function performs metabolic simulations and generates various results, including net secretion fluxes. Finally, metabolite IDs are extracted from the generated inputDiet_net_secretion_fluxes.csv file and matched to actual metabolite names by referencing a reaction list file. The entire analysis is conducted in MATLAB.

